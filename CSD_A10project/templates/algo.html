<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Algorithm Accuracy</title>
    <link rel="icon" href="data:,">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    <link href="/static/css/style.css" rel="stylesheet">
    <style>
        body {
            background-color: var(--bg-color) !important;
            color: var(--text-color);
        }

        .algo-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 40px;
            margin-top: 50px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        h1,
        h2,
        h3 {
            color: var(--primary) !important;
            font-weight: 800;
        }

        .form-select,
        .btn-primary {
            border-radius: 10px;
        }

        .form-select {
            background-color: var(--glass-bg) !important;
            border: 1px solid var(--glass-border) !important;
            color: var(--text-color) !important;
        }

        option {
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .table {
            color: var(--text-color);
        }

        .table thead {
            background: rgba(168, 85, 247, 0.2);
            color: var(--primary);
        }
    </style>
</head>

<body>

    <!-- Navbar Start -->
    <nav class="navbar navbar-expand-lg navbar-dark px-4 px-lg-5 py-3 py-lg-0 sticky-top">
        <a href="" class="navbar-brand p-0">
            <h1>CyberDetect AI</h1>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="fa fa-bars"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav ms-auto py-0">
                <a href="{{url_for('viewdata')}}" class="nav-item nav-link">VIEWDATA</a>
                <a href="{{url_for('algo')}}" class="nav-item nav-link">ALGO</a>
                <a href="{{url_for('upload')}}" class="nav-item nav-link">UPLOAD</a>
                <a href="{{url_for('prediction')}}" class="nav-item nav-link">PREDICTION</a>
                <a href="{{url_for('dashboard')}}" class="nav-item nav-link">DASHBOARD</a>
                <a href="{{url_for('forensics')}}" class="nav-item nav-link">FORENSICS</a>
                <a href="{{url_for('logout')}}" class="nav-item nav-link">LOGOUT</a>
            </div>
        </div>
    </nav>
    <!-- Navbar End -->

    <!-- Algorithm Selection Form and Results Display -->
    <div class="container pb-5">
        <div class="algo-container animate__animated animate__fadeIn">
            <h1 class="text-center">Select an Algorithm</h1>
            <form method="POST" action="/algo">
                <div class="mb-3">
                    <label for="model" class="form-label">Choose an Algorithm</label>
                    <select name="model" id="model" class="form-select">
                        <option value="" disabled selected>Select an AI Algorithm...</option>
                        {% for model in models %}
                        <option value="{{ model }}" {% if model==selected_model %}selected{% endif %}>
                            {{ model }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>

            <!-- Display results after form submission -->
            {% if accuracy %}
            <hr>
            <h2>Results for {{ selected_model }}</h2>
            <p><strong>Accuracy:</strong> {{ accuracy }}</p>

            <!-- Confusion Matrix -->
            <h3>Confusion Matrix</h3>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Predicted/Actual</th>
                        {% for i in confusion_matrix_ %}
                        <th>{{ loop.index }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in confusion_matrix_ %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        {% for cell in row %}
                        <td>{{ cell }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <!-- Classification Report -->
            <h3>Classification Report</h3>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Precision</th>
                        <th>Recall</th>
                        <th>F1-Score</th>
                    </tr>
                </thead>
                <tbody>
                    {% set label_map = {'0': 'Blackhole', '1': 'Flooding', '2': 'Grayhole', '3': 'Normal', '4': 'TDMA'}
                    %}
                    {% for label, metrics in classification_report_.items() %}
                    {% if label in ['0', '1', '2', '3', '4'] %}
                    <tr>
                        <td>{{ label_map.get(label, label) }}</td>
                        <td>{{ metrics['precision']|round(4) }}</td>
                        <td>{{ metrics['recall']|round(4) }}</td>
                        <td>{{ metrics['f1-score']|round(4) }}</td>
                    </tr>
                    {% endif %}
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}
        </div>

        <!-- Footer -->
        <footer class="footer mt-auto">
            <div class="container text-center">
                <p class="footer-text">Â© 2026 <span class="footer-highlight">A10</span>. All Rights Reserved.</p>
            </div>
        </footer>

        <!-- Bootstrap JS and dependencies -->
        {% include 'chatbot_fragment.html' %}
</body>

</html>